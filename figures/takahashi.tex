\iffalse
\newcommand{\FigTakahashi}[1]{
  \begin{figure}[h]
  \centering
  \begin{align*}
  x^\bullet_{\Phi; \Gamma} &= e^\bullet_{\Phi; \Gamma} \qquad \textit{if $(\define{x}{\tau}{e}) \in \Gamma$} \\
  (\app{(\fun{x}{\tau}{e})}{e'})^\bullet_{\Phi; \Gamma} &= \subst{e^\bullet_{\Phi; \Gamma}}{x}{e'^\bullet_{\Phi; \Gamma}} \\
  (\App{(\Fun{\alpha}{e})}{s})^\bullet_{\Phi; \Gamma} &= \subst{e^\bullet_{\Phi, \alpha; \Gamma}}{\alpha}{s} \\
  (\App{(\Fun<{\alpha}{r}{e})}{s})^\bullet_{\Phi; \Gamma} &= \subst{e^\bullet_{\Phi, \bound{\alpha}{r}; \Gamma}}{\alpha}{s} \\
  (\letin{x}{\tau}{e'}{e})^\bullet_{\Phi; \Gamma} &= \subst{e^\bullet_{\Phi; \Gamma}}{x}{e'^\bullet_{\Phi; \Gamma}} \\
  (\match*{\App{\zero*_{\any}}{s}}{(\App{\zero*}{\alpha} \Rightarrow e)\any})^\bullet_{\Phi; \Gamma}
    &= \subst{e^\bullet_{\Phi; \Gamma}}{\alpha}{s} \\
  (\match*{\app{\App{\succ*_{\any}}{s}}{e'}}{\any(\app{\App{\succ*}{\alpha}}{z} \Rightarrow e)})^\bullet_{\Phi; \Gamma}
    &= \subst{e^\bullet_{\Phi; \Gamma}}{\alpha, z}{s, e'^\bullet_{\Phi; \Gamma}} \\
  (\match*{\app{\App{\sup*_{\any}}{s}}{e_1}{e_2}}{(\app{\App{\sup*}{\alpha}}{z_1}{z_2} \Rightarrow e)})^\bullet_{\Phi; \Gamma}
    &= \subst{e^\bullet_{\Phi; \Gamma}}{\alpha, z_1, z_2}{s, {e_1}^\bullet_{\Phi; \Gamma}, {e_2}^\bullet_{\Phi; \Gamma}} \\
  (\App{(\fix{f}{\alpha}{\tau}{e})}{s})^\bullet_{\Phi; \Gamma}
    &= \subst{e^\bullet_{\Phi, \alpha; \Gamma}}{\alpha, f}{s, \Fun<{\beta}{s}{\App{(\fix{f}{\alpha}{\tau^\bullet_{\Phi, \alpha; \Gamma}}{e^\bullet_{\Phi, \alpha; \Gamma}})}{\beta}}} \\
    &\mathrel{\phantom{=}} \textit{if $\subsize{\Phi}{\sss{r}}{s}$} \\
  (\funtype{x}{\sigma}{\tau})^\bullet_{\Phi; \Gamma} &= \funtype{x}{\sigma^\bullet_{\Phi; \Gamma}}{\tau^\bullet_{\Phi; \Gamma}} \\
  (\fun{x}{\sigma}{e})^\bullet_{\Phi; \Gamma} &= \fun{x}{\sigma^\bullet_{\Phi; \Gamma}}{e^\bullet_{\Phi; \Gamma}} \\
  (\app{e}{e_2})^\bullet_{\Phi; \Gamma} &= \app{{e_1}^\bullet_{\Phi; \Gamma}}{{e_2}^\bullet_{\Phi; \Gamma}} \\
  (\Funtype{\alpha}{\tau})^\bullet_{\Phi; \Gamma} &= \Funtype{\alpha}{\tau^\bullet_{\Phi, \alpha; \Gamma}} \\
  (\Funtype<{\alpha}{s}{\tau})^\bullet_{\Phi; \Gamma} &= \Funtype<{\alpha}{s}{\tau^\bullet_{\Phi, \bound{\alpha}{s}; \Gamma}} \\
  (\Fun{\alpha}{e})^\bullet_{\Phi; \Gamma} &= \Fun{\alpha}{e^\bullet_{\Phi, \alpha; \Gamma}} \\
  (\Fun<{\alpha}{s}{e})^\bullet_{\Phi; \Gamma} &= \Fun<{\alpha}{s}{e^\bullet_{\Phi, \bound{\alpha}{s}; \Gamma}} \\
  (\App{e}{s})^\bullet_{\Phi; \Gamma} &= \App{e^\bullet_{\Phi; \Gamma}}{s} \\
  (\succ{s}{r}{e})^\bullet_{\Phi; \Gamma} &= \succ{s}{r}{e^\bullet_{\Phi; \Gamma}} \\
  (\W{x}{\sigma}{\tau}{s})^\bullet_{\Phi; \Gamma} &= \W{x}{\sigma^\bullet_{\Phi; \Gamma}}{\tau^\bullet_{\Phi; \Gamma}}{s} \\
  (\sup{x}{\sigma}{\tau}{s}{r}{e_1}{e_2})^\bullet_{\Phi; \Gamma} &= \sup{x}{\sigma^\bullet_{\Phi; \Gamma}}{\tau^\bullet_{\Phi; \Gamma}}{s}{r}{{e_1}^\bullet_{\Phi; \Gamma}}{{e_2}^\bullet_{\Phi; \Gamma}} \\
  (\match{e'}{\fun{x}{P}}{(\app{\App{c}{\alpha}}{\vec{z}} \Rightarrow e) \seq})^\bullet_{\Phi; \Gamma}
    &= \match{e'^\bullet_{\Phi; \Gamma}}{\fun{x}{P^\bullet_{\Phi; \Gamma}}}{(\app{\App{c}{\alpha}}{\vec{z}} \Rightarrow e^\bullet_{\Phi; \Gamma}) \seq} \\
  (\fix{f}{\alpha}{\tau}{e})^\bullet_{\Phi; \Gamma} &= \fix{f}{\alpha}{\tau^\bullet_{\Phi, \alpha; \Gamma}}{e^\bullet_{\Phi, \alpha; \Gamma}} \\
  e^\bullet_{\Phi; \Gamma} &= e
  \end{align*}
  \caption[Complete development for \lang]{Extension of Takahashi's complete development for \lang}
  \label{#1}
  \end{figure}
}
\fi

\newcommand{\FigTakahashi}[1]{
  \begin{figure}[h]
  \centering
  \begin{mathpar}
  \fbox{$\develop{\Phi; \Gamma}{e}{e}$} \hfill \\
  \inferrule[]{
    (\define{x}{\tau}{e}) \in \Gamma \\
    \develop{\Phi; \Gamma}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{x}{e'}
  }
  \and
  \inferrule[]{
    \develop{\Phi; \Gamma, \annot{x}{\tau}}{e_1}{e'_1} \\
    \develop{\Phi; \Gamma}{e_2}{e'_2}
  }{
    \develop{\Phi; \Gamma}{\app{(\fun{x}{\tau}{e_1})}{e_2}}{\subst{e'_1}{x}{e'_2}}
  }
  \and
  \inferrule[]{
    \develop{\Phi, \alpha; \Gamma}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\App{(\Fun{\alpha}{e})}{s}}{\subst{e'}{\alpha}{s}}
  }
  \and
  \inferrule[]{
    \develop{\Phi, \bound{\alpha}{r}; \Gamma}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\App{\Fun<{\alpha}{r}{e}}{s}}{\subst{e'}{\alpha}{s}}
  }
  \and
  \inferrule[]{
    \develop{\Phi; \Gamma}{e_1}{e'_1} \\
    \develop{\Phi; \Gamma, \define{x}{\tau}{e_1}}{e_2}{e'_2}
  }{
    \develop{\Phi; \Gamma}{\letin{x}{\tau}{e_1}{e_2}}{\subst{e'_2}{x}{e'_1}}
  }
  \and
  \inferrule[]{
    \develop{\Phi, \bound{\alpha}{r}; \Gamma}{e_z}{e_z'}
  }{
    \develop{\Phi; \Gamma}{
      \match*{\zero{r}{s}}{(\App{\zero*}{\alpha} \Rightarrow e_z) \any}
    }{\subst{e'_z}{\alpha}{s}}
  }
  \and
  \inferrule[]{
    \develop{\Phi; \Gamma}{e}{e'} \\
    \develop{\Phi, \bound{\alpha}{r}; \Gamma, \annot{z}{\N{\alpha}}}{e_s}{e'_s}
  }{
    \develop{\Phi; \Gamma}{
      \match*{\succ{r}{s}{e}}{\any (\app{\App{\succ*}{\alpha}}{z} \Rightarrow e_s)}
    }{\subst{e'_s}{\alpha, z}{s, e'}}
  }
  \and
  \inferrule[]{
    \develop{\Phi; \Gamma}{e_1}{e'_1} \\
    \develop{\Phi; \Gamma}{e_2}{e'_2} \\
    \develop{\Phi, \bound{\alpha}{r}; \Gamma, \annot{z_1}{\sigma}, \annot{z_2}{\subst{\tau}{x}{z_1}}}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{
      \match*{\sup{x}{\sigma}{\tau}{r}{s}{e_1}{e_2}}{(\app{\App{\sup*}{\alpha}}{z_1}{z_2} \Rightarrow e)}
    }{\subst{e'}{\alpha, z_1, z_2}{s, e'_1, e'_2}}
  }
  \and
  \inferrule[]{
    \subsize{\Phi}{\sss{r}}{s} \\
    \develop{\Phi, \alpha; \Gamma}{\tau}{\tau'} \\
    \develop{\Phi, \alpha; \Gamma, \annot{f}{\Funtype<{\beta}{\alpha}{\subst{\tau}{\alpha}{\beta}}}}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\App{\fix{f}{\alpha}{\tau}{e}}{s}}{\subst{e'}{\alpha, f}{s, \Fun<{\beta}{s}{\App{(\fix{f}{\alpha}{\tau'}{e'})}{\beta}}}}
  }
  \end{mathpar}
  \caption[Complete development for \lang]{Extension of Takahashi's complete development for \lang \\ (excerpt excl. congruence)}
  \label{#1}
  \end{figure}
}

\newcommand{\FigTakahashiFull}[1]{
  \begin{mathpar}
  \setlength{\jot}{-1.5pt}
  \fbox{$\develop{\Phi; \Gamma}{e}{e}$} \hfill
  \inferrule[]{
    (\define{x}{\tau}{e}) \in \Gamma \\
    \develop{\Phi; \Gamma}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{x}{e'}
  }
  \and
  \inferrule[]{
    \develop{\Phi; \Gamma, \annot{x}{\tau}}{e_1}{e'_1} \\
    \develop{\Phi; \Gamma}{e_2}{e'_2}
  }{
    \develop{\Phi; \Gamma}{\app{(\fun{x}{\tau}{e_1})}{e_2}}{\subst{e'_1}{x}{e'_2}}
  }
  \and
  \inferrule[]{
    \develop{\Phi, \alpha; \Gamma}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\App{(\Fun{\alpha}{e})}{s}}{\subst{e'}{\alpha}{s}}
  }
  \and
  \inferrule[]{
    \develop{\Phi, \bound{\alpha}{r}; \Gamma}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\App{\Fun<{\alpha}{r}{e}}{s}}{\subst{e'}{\alpha}{s}}
  }
  \and
  \inferrule[]{
    \develop{\Phi; \Gamma}{e_1}{e'_1} \\
    \develop{\Phi; \Gamma, \define{x}{\tau}{e_1}}{e_2}{e'_2}
  }{
    \develop{\Phi; \Gamma}{\letin{x}{\tau}{e_1}{e_2}}{\subst{e'_2}{x}{e'_1}}
  }
  \and
  \inferrule[]{
    \develop{\Phi, \bound{\alpha}{r}; \Gamma}{e_z}{e_z'}
  }{
    \develop{\Phi; \Gamma}{
      \match*{\zero{r}{s}}{(\App{\zero*}{\alpha} \Rightarrow e_z) \any}
    }{\subst{e'_z}{\alpha}{s}}
  }
  \and
  \inferrule[]{
    \develop{\Phi; \Gamma}{e}{e'} \\
    \develop{\Phi, \bound{\alpha}{r}; \Gamma, \annot{z}{\N{\alpha}}}{e_s}{e'_s}
  }{
    \develop{\Phi; \Gamma}{
      \match*{\succ{r}{s}{e}}{\any (\app{\App{\succ*}{\alpha}}{z} \Rightarrow e_s)}
    }{\subst{e'_s}{\alpha, z}{s, e'}}
  }
  \and
  \inferrule[]{
    \develop{\Phi; \Gamma}{e_1}{e'_1} \\
    \develop{\Phi; \Gamma}{e_2}{e'_2} \\
    \develop{\Phi, \bound{\alpha}{r}; \Gamma, \annot{z_1}{\sigma}, \annot{z_2}{\subst{\tau}{x}{z_1}}}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{
      \match*{\sup{x}{\sigma}{\tau}{r}{s}{e_1}{e_2}}{(\app{\App{\sup*}{\alpha}}{z_1}{z_2} \Rightarrow e)}
    }{\subst{e'}{\alpha, z_1, z_2}{s, e'_1, e'_2}}
  }
  \and
  \inferrule[]{
    \subsize{\Phi}{\sss{r}}{s} \\
    \develop{\Phi, \alpha; \Gamma}{\tau}{\tau'} \\
    \develop{\Phi, \alpha; \Gamma, \annot{f}{\Funtype<{\beta}{\alpha}{\subst{\tau}{\alpha}{\beta}}}}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\App{\fix{f}{\alpha}{\tau}{e}}{s}}{\subst{e'}{\alpha, f}{s, \Fun<{\beta}{s}{\App{(\fix{f}{\alpha}{\tau'}{e'})}{\beta}}}}
  }
  \and
  \inferrule{
    \develop{\Phi; \Gamma}{\sigma}{\sigma'} \\
    \develop{\Phi; \Gamma, \annot{x}{\sigma}}{\tau}{\tau'}
  }{
    \develop{\Phi; \Gamma}{\funtype{x}{\sigma}{\tau}}{\funtype{x}{\sigma'}{\tau}}
  }
  \and
  \inferrule{
    \develop{\Phi; \Gamma}{\sigma}{\sigma'} \\
    \develop{\Phi; \Gamma, \annot{x}{\sigma}}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\fun{x}{\sigma}{e}}{\fun{x}{\sigma'}{e}}
  }
  \and
  \inferrule{
    \develop{\Phi; \Gamma}{e_1}{e'_1} \\
    \develop{\Phi; \Gamma}{e_2}{e'_2}
  }{
    \develop{\Phi; \Gamma}{\app{e_1}{e_2}}{\app{e'_1}{e'_2}}
  }
  \and
  \inferrule{
    \develop{\Phi, \alpha; \Gamma}{\tau}{\tau'}
  }{
    \develop{\Phi; \Gamma}{\Funtype{\alpha}{\tau}}{\Funtype{\alpha}{\tau'}}
  }
  \and
  \inferrule{
    \develop{\Phi, \alpha; \Gamma}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\Fun{\alpha}{e}}{\Fun{\alpha}{e'}}
  }
  \and
  \inferrule{
    \develop{\Phi; \Gamma}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\App{e}{s}}{\App{e'}{s}}
  }
  \and
  \inferrule{
    \develop{\Phi, \bound{\alpha}{s}; \Gamma}{\tau}{\tau'}
  }{
    \develop{\Phi; \Gamma}{\Funtype<{\alpha}{s}{\tau}}{\Funtype<{\alpha}{s}{\tau'}}
  }
  \and
  \inferrule{
    \develop{\Phi, \bound{\alpha}{s}; \Gamma}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\Fun<{\alpha}{s}{e}}{\Fun<{\alpha}{s}{e'}}
  }
  \and
  \inferrule{
    \develop{\Phi, \alpha; \Gamma}{\tau}{\tau'} \\\\
    \develop{\Phi, \alpha; \Gamma, \annot{f}{\Funtype<{\beta}{\alpha}{\subst{\tau}{\alpha}{\beta}}}}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\fix{f}{\alpha}{\tau}{e}}{\fix{f}{\alpha}{\tau'}{e}}
  }
  \and
  \inferrule{
    \develop{\Phi; \Gamma}{\sigma}{\sigma'} \\
    \develop{\Phi; \Gamma, \annot{x}{\sigma}}{\tau}{\tau'}
  }{
    \develop{\Phi; \Gamma}{\W{x}{\sigma}{\tau}{s}}{\W{x}{\sigma'}{\tau'}{s}}
  }
  \and
  \inferrule{
    \develop{\Phi; \Gamma}{e}{e'}
  }{
    \develop{\Phi; \Gamma}{\succ{r}{s}{e}}{\succ{r}{s}{e'}}
  }
  \and
  \inferrule{
    \develop{\Phi; \Gamma}{\sigma}{\sigma'} \\
    \develop{\Phi; \Gamma, \annot{x}{\sigma}}{\tau}{\tau'} \\\\
    \develop{\Phi; \Gamma}{e_1}{e'_1} \\
    \develop{\Phi; \Gamma}{e_2}{e'_2}
  }{
    \develop{\Phi; \Gamma}{\sup{x}{\sigma}{\tau}{r}{s}{e_1}{e_2}}{\sup{x}{\sigma'}{\tau'}{r}{s}{e'_1}{e'_2}}
  }
  \and
  \inferrule{
    \develop{\Phi; \Gamma}{e}{e'} \\
    \develop{\Phi; \Gamma, \annot{x}{\N{s}}}{P}{P'} \\\\
    \develop{\Phi, \bound{\alpha}{s}; \Gamma}{e_z}{e'_z} \\
    \develop{\Phi, \bound{\beta}{s}; \Gamma, \annot{z}{\N{\beta}}}{e_s}{e'_s}
  }{
    \develop{\Phi; \Gamma}{
      \begin{aligned}
      &\match{e}{\fun{x}{\N{s}}{P}}{ \\
      &\quad \App{\zero*}{\alpha} \Rightarrow e_z \\
      &\quad \app{\App{\succ*}{\beta}}{z} \Rightarrow e_s}
      \end{aligned}
    }{
      \begin{aligned}
      &\match{e'}{\fun{x}{\N{s}}{P'}}{ \\
      &\quad \App{\zero*}{\alpha} \Rightarrow e'_z \\
      &\quad \app{\App{\succ*}{\beta}}{z} \Rightarrow e'_s}
      \end{aligned}
    }
  }
  \and
  \inferrule{
    \develop{\Phi; \Gamma}{e}{e'} \\
    \develop{\Phi; \Gamma, \annot{x}{\W{y}{\sigma}{\tau}{s}}}{P}{P'} \\\\
    \develop{\Phi, \bound{\alpha}{s}; \Gamma, \annot{z_1}{\sigma}, \annot{z_2}{\arr*{\subst{\tau}{y}{z_1}}{\W{y}{\sigma}{\tau}{\alpha}}}}{e_s}{e'_s}
  }{
    \develop{\Phi; \Gamma}{
      \begin{aligned}
      &\match{e}{\fun{x}{\W{y}{\sigma}{\tau}{s}}{P}}{ \\
      &\quad \app{\App{\sup*}{\alpha}}{z_1}{z_2} \Rightarrow e_s}
      \end{aligned}
    }{
      \begin{aligned}
      &\match{e'}{\fun{x}{\W{y}{\sigma}{\tau}{s}}{P'}}{ \\
      &\quad \app{\App{\sup*}{\alpha}}{z_1}{z_2} \Rightarrow e'_s}
      \end{aligned}
    }
  }
  \and
  \inferrule{~}{
    \develop{\Phi; \Gamma}{e}{e}
  }
  \end{mathpar}
}